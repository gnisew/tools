/**
 * 實驗三：高度角觀測專用樣式 - 最終整合版
 */

/* --- 1. 觀測器與控制面板整合 --- */

/* 觀測主容器：移除底部圓角，與下方面板接合 */
.obs-container {
    width: 100%;
    height: 400px;
    background: #05070a;
    border-radius: 16px 16px 0 0;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    border: 2px solid var(--border-color);
    border-bottom: none; /* 移除接縫處線條 */
}

/* 下方整合式面板：包裹滑桿與工具列 */
.unified-control-panel {
    width: 100%;
    background: var(--panel-bg);
    border: 2px solid var(--border-color);
    border-radius: 0 0 16px 16px;
    padding-bottom: 5px;
    margin-top: -1px; /* 確保與上方容器無縫重疊 */
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}

/* 滑桿區塊：融入背景，減少視覺層級 */
.slider-wrapper {
    padding: 15px 25px 5px 25px;
    background: transparent;
}

/* --- 2. 核心觀測元件與 Emoji 翻轉修正 --- */

.observer-box {
    width: 600px;
    height: 400px;
    position: relative;
    margin: 0 auto;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    /* 翻轉中心必須與 JS 的 CENTER_X/Y 完全一致 (300, 340) */
    transform-origin: 300px 340px; 
}

/* 當方位切換至東側時，父容器水平翻轉 */
.observer-box.east-side {
    transform: scaleX(-1);
}

/* 觀測者 Emoji：簡單穩定的翻轉邏輯 */
.obs-center-icon {
    position: absolute;
    /* 核心：永遠先置中位移，再進行縮放 */
    /* scaleX(-1) 假設您的 Emoji 預設朝左，此處將其轉向右側 (面向刻度) */
    transform: translate(-50%, -50%) scaleX(-1); 
    font-size: 1.8rem; 
    cursor: pointer;
    z-index: 5;
    user-select: none;
    /* 固定位置，不使用 transition 避免抖動 */
}

/* 補償修正：當父層翻轉時，維持相同的位移與縮放 */
.observer-box.east-side .obs-center-icon {
    /* 在 scaleX(-1) 的父層中再執行一次 scaleX(-1)，會讓鳥兒轉向左側 */
    transform: translate(-50%, -50%) scaleX(-1) !important; 
}

/* 月球與文字的鏡像補償 */
.obs-moon {
    position: absolute;
    z-index: 10;
    transform: translate(-50%, -50%);
    pointer-events: none;
}

.observer-box.east-side .obs-moon {
    /* 抵消父層翻轉，確保月相方向正確 */
    transform: translate(-50%, -50%) scaleX(-1) !important;
}

.observer-box.east-side .protractor-text,
.observer-box.east-side .guide-text {
    /* 抵消父層翻轉，確保數字不變鏡像文字 */
    transform: scaleX(-1);
    transform-box: fill-box;
    transform-origin: center;
}

/* --- 3. 量角器與資訊 UI --- */

.protractor-text {
    font-size: 16px;
    fill: rgba(255,255,255,0.7);
    font-family: Arial, sans-serif;
}

.guide-text {
    font-size: 13px;
    fill: #6aa;
    font-weight: bold;
}

.altitude-toolbar {
    margin-top: 0 !important;
    border: none !important;
    background: transparent !important;
    box-shadow: none !important;
}

.obs-status-capsule {
    display: flex;
    gap: 12px;
    background: rgba(0, 0, 0, 0.3);
    padding: 6px 14px;
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.status-item {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.status-item span {
    color: var(--accent-color);
    font-weight: bold;
    font-family: monospace;
}

/* --- 4. 響應式優化 --- */
@media (max-width: 600px) {
    .observer-box {
        transform: scale(0.85);
        transform-origin: 300px 340px;
    }
    .observer-box.east-side {
        transform: scale(-0.85, 0.85); /* 同時處理縮放與翻轉 */
    }
    .slider-wrapper {
        padding: 10px 15px 0 15px;
    }
}