<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>透鏡成像實驗室 - 烏衣行</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="app">
    <div class="top-bar">
        <a href="../index.html" class="flex items-center gap-2 px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded text-sm font-bold transition">
            <span>⬅ 返回選單</span>
        </a>
        <div class="absolute left-1/2 transform -translate-x-1/2 text-xs md:text-sm font-bold text-slate-200 pointer-events-none whitespace-nowrap">
            拖曳物體移動，拖曳紅點改變焦距
        </div>
    </div>

    <div class="canvas-area" ref="containerRef">
        <canvas ref="canvasRef"
            class="interactive"
            @pointerdown="handleStart"
            @pointermove="handleMove"
            @pointerup="handleEnd"
            @pointercancel="handleEnd"
            @pointerleave="handleEnd"
            @contextmenu.prevent>
        </canvas>

        <div class="absolute top-4 right-4 z-40 flex flex-col gap-4">
            <div class="bg-slate-800/90 p-1.5 rounded-lg border border-slate-600 flex gap-1 backdrop-blur-sm shadow-xl">
                <button @click="lensParams.type = 'convex'" 
                    class="px-4 py-2 rounded text-sm font-bold transition"
                    :class="lensParams.type === 'convex' ? 'bg-blue-600 text-white shadow' : 'text-slate-400 hover:text-white'">
                    凸透鏡
                </button>
                <button @click="lensParams.type = 'concave'" 
                    class="px-4 py-2 rounded text-sm font-bold transition"
                    :class="lensParams.type === 'concave' ? 'bg-blue-600 text-white shadow' : 'text-slate-400 hover:text-white'">
                    凹透鏡
                </button>
            </div>
            
            <select v-model="lensParams.objEmoji" 
                    class="bg-slate-800/90 text-white text-sm rounded-lg p-2 border border-slate-600 outline-none cursor-pointer backdrop-blur-sm hover:border-blue-500 transition shadow-xl">
                <option v-for="opt in lensObjects" :key="opt.emoji" :value="opt.emoji">
                    {{ opt.emoji }} {{ opt.label }}
                </option>
            </select>
        </div>

        <div class="absolute bottom-4 left-4 z-40 bg-slate-900/90 border border-slate-700 p-4 rounded-xl shadow-xl backdrop-blur-md min-w-[180px] pointer-events-none">
            <div class="grid grid-cols-[1fr_auto] gap-y-2 text-sm font-mono">
                <span class="text-slate-300">焦距 (f):</span>
                <span class="text-green-400 font-bold text-right">{{ Math.abs(Math.round(lensParams.f)) }} cm</span>
                
                <span class="text-slate-300">物距 (do):</span>
                <span class="text-blue-400 font-bold text-right">{{ Math.round(lensParams.objDist) }} cm</span>
                
                <span class="text-slate-300">像距 (di):</span>
                <span class="text-purple-400 font-bold text-right">{{ isFinite(lensData.di) ? Math.abs(Math.round(lensData.di)) : '∞' }} cm</span>
                
                <span class="text-slate-300">放大率 (M):</span>
                <span class="text-yellow-400 font-bold text-right">{{ Math.abs(lensData.m).toFixed(2) }}x</span>
            </div>
            
            <div class="mt-3 pt-2 border-t border-slate-700 text-center font-bold text-sm"
                 :class="lensData.isReal ? 'text-orange-400' : 'text-cyan-400'">
                {{ lensData.desc }}
            </div>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>